<!-- Copyright (C) 2023 anonymous

This file is part of PSFree.

PSFree is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as
published by the Free Software Foundation, either version 3 of the
License, or (at your option) any later version.

PSFree is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <https://www.gnu.org/licenses/>.
-->
<html>
<script>
if (navigator.userAgent.includes('PlayStation 4')) {
    var UA = navigator.userAgent.substring(navigator.userAgent.indexOf('5.0 (') + 19, navigator.userAgent.indexOf(') Apple')).replace("PlayStation 4/","");
    if (UA == "6.00" || UA == "6.02" || UA == "6.10" || UA == "6.20") { 
        alert(`Current Firmware: ${UA}. Are You Ready?`);
    } else if (UA == "6.50" || UA == "6.70" || UA == "6.71" || UA == "6.72") { 
        alert(`Current Firmware: ${UA}. Are You Ready?`);
    } else if (UA == "7.01" || UA == "7.02" || UA == "7.50" || UA == "7.51" || UA == "7.55" || UA == "8.00" || UA == "8.01" || UA == "8.03" || UA == "8.50" || UA == "8.51") { 
        alert(`Current Firmware: ${UA}. Are You Ready?`);
    } else {
        var UA = navigator.userAgent.substring(navigator.userAgent.indexOf('5.0 (') + 18, navigator.userAgent.indexOf(') Apple')).replace("PlayStation 4/","");
        if (UA == "9.00" || UA == "9.03" || UA == "9.04" || UA == "9.50" ||  UA == "9.51" || UA == "9.60") {
            alert(`Current Firmware: ${UA}. Are You Ready?`);
        } else {
            alert(`Current PS4 Firmware Not Supported`);
			window.stop();
        }
    }
} else if (navigator.userAgent.includes('PlayStation 5')) {
    var UA = navigator.userAgent.substring(navigator.userAgent.indexOf('5.0 (') + 32, navigator.userAgent.indexOf(') Apple')).replace("PlayStation 5/","");
    if (UA == "1.00" || UA == "1.01" || UA == "1.02" || UA == "1.05" || UA == "1.12" || UA == "1.14" || UA == "2.00" || UA == "2.10" || UA == "2.20" || UA == "2.25" || UA == "2.26" || UA == "2.30" || UA == "2.50" || UA == "2.70" || UA == "3.00" || UA == "3.10" || UA == "3.20" || UA == "3.21" || UA == "4.00" || UA == "4.02" || UA == "4.03" || UA == "4.50" || UA == "4.51" || UA == "5.00" || UA == "5.02" || UA == "5.10" || UA == "5.50")  { 
        alert(`Current Firmware: ${UA}. Are You Ready?`);
    } else {
        alert(`Current PS5 Firmware (${UA}) Not Supported`);
		window.stop();
    }
}
</script>
    <head>
        <meta charset='utf-8'>
        <title>PSFree 1.4.0</title>
    </head>

    <body>
        PS4/PS5 exploit using CVE-2022-22620<br>
        PS4 versions vulnerable: 6.xx-9.xx (tested 6.00-9.60)<br>
        PS5 versions vulnerable: 1.xx-5.xx (tested 1.00-5.50)<br>
        <a href="./about.html" data-jslicense="1">JavaScript license information</a>
    </body>
    <script type='module' src='./alert.mjs'></script>
</html>
